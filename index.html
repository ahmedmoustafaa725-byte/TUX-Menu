<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TUX — Burgers Worth The Chase …</title>
  <meta name="description" content="TUX — Smash burgers, hawawshi, fries, and TUXIFY. El-Saada St – Zahraa El-Maadi.">
  <link rel="icon" href="assets/img/logo.jpg">
  <link rel="apple-touch-icon" href="assets/img/logo.jpg">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Topbar -->
  <header class="topbar">
    <div class="container bar">
      <a href="#" class="brand" aria-label="TUX Home">
        <img src="assets/img/logo.jpg" alt="TUX logo" class="brand__logo">
        <div class="brand__text">
          <div class="brand__title">TUX</div>
          <div class="brand__tag">Burgers Worth The Chase …</div>
        </div>
      </a>
      <nav class="nav">
                        <a href="#order">Order</a>
        <a href="#menu">Menu</a>
        <a href="#gallery">Gallery</a>
        <a href="#location">Location</a>
        <a href="#contact">Contact</a>
        <a class="cta red" href="tel:01151960048">Call 011-5196-0048</a>
        <a class="cta blue" href="https://forms.gle/rKJoUeHkgLoqTmmXA" target="_blank" rel="noreferrer">Help Us Improve</a>
      </nav>
    </div>
  </header>

  <!-- Quick access for mobile -->
  <nav class="quick-nav" aria-label="Quick access">
        <a href="#order">Order</a>

    <a href="#menu">Menu</a>
    <a href="#gallery">Gallery</a>
    <a href="#location">Location</a>
    <a href="#contact">Contact</a>
    <!-- Mobile-only review link -->
    <a href="https://maps.app.goo.gl/V8U4SKzMqHvT5o2m7" target="_blank" rel="noreferrer">Review</a>
  </nav>

  <!-- Hero -->
  <section class="hero" style="--hero:url('assets/img/poster-tuxify.jpg')">
    <div class="veil"></div>
    <div class="container hero__content">
      <div class="hero__copy">
        <h1>Elegance in Every Bite</h1>
        <p>Smash burgers, golden fries, authentic hawawshi, and our signature <strong>TUXIFY</strong> line.</p>
        <div class="actions">
          <a class="btn red" href="https://wa.me/201151960048?text=Hi%20TUX%20I%20want%20to%20order%20" target="_blank" rel="noreferrer">Order Now</a>
          <a class="btn outline" href="https://maps.app.goo.gl/V8U4SKzMqHvT5o2m7" target="_blank" rel="noreferrer">Find us on Maps</a>
        </div>
      </div>
      <div class="hero__logo">
        <img src="assets/img/logo.jpg" alt="TUX">
      </div>
    </div>
  </section>
   <section id="account" class="section">
    <div class="container">
      <header class="section__head">
        <h2>Account</h2>
        <p class="muted">Create an account or sign in to manage your details and speed through checkout.</p>
      </header>

      <div class="auth-grid">
        <div class="panel auth-panel" id="auth-status">
          <h3>Welcome</h3>
          <p class="muted" data-auth-status>Sign in to save your contact information for future orders.</p>
          <button type="button" class="btn outline" data-action="logout" hidden>Log Out</button>
          <p class="form-feedback" id="auth-global-message" role="alert" aria-live="polite"></p>
        </div>

        <div class="panel auth-panel" id="login-panel">
          <h3>Log In</h3>
          <form id="login-form" novalidate>
            <div class="field-group">
              <label for="loginEmail">Email</label>
              <input type="email" id="loginEmail" name="email" autocomplete="email" required>
            </div>
            <div class="field-group">
              <label for="loginPassword">Password</label>
              <input type="password" id="loginPassword" name="password" autocomplete="current-password" required>
            </div>
            <div class="field-group">
              <button type="submit" class="btn red">Log In</button>
              <button type="button" class="btn link" data-action="show-forgot">Forgot password?</button>
            </div>
            <p class="form-feedback" data-feedback="login" role="alert" aria-live="polite"></p>
          </form>
        </div>

        <div class="panel auth-panel" id="register-panel">
          <h3>Register</h3>
          <form id="register-form" novalidate>
            <div class="field-group">
              <label for="registerName">Name</label>
              <input type="text" id="registerName" name="name" autocomplete="name" required>
            </div>
            <div class="field-group">
              <label for="registerEmail">Email</label>
              <input type="email" id="registerEmail" name="email" autocomplete="email" required>
            </div>
            <div class="field-group">
              <label for="registerPassword">Password</label>
              <input type="password" id="registerPassword" name="password" autocomplete="new-password" required>
            </div>
            <div class="field-group">
              <label for="registerPhone">Phone</label>
              <input type="tel" id="registerPhone" name="phone" autocomplete="tel">
            </div>
            <div class="field-group">
              <label for="registerAddress">Address</label>
              <textarea id="registerAddress" name="address" rows="3"></textarea>
            </div>
            <div class="field-group">
              <button type="submit" class="btn outline">Create Account</button>
            </div>
            <p class="form-feedback" data-feedback="register" role="alert" aria-live="polite"></p>
          </form>
        </div>

        <div class="panel auth-panel" id="profile-panel" hidden>
          <h3>Your Profile</h3>
          <form id="profile-form" novalidate>
            <div class="field-group">
              <label for="profileEmail">Email</label>
              <input type="email" id="profileEmail" name="email" autocomplete="email" required>
            </div>
            <div class="field-group">
              <label for="profileName">Name</label>
              <input type="text" id="profileName" name="name" autocomplete="name" required>
            </div>
            <div class="field-group">
              <label for="profilePhone">Phone</label>
              <input type="tel" id="profilePhone" name="phone" autocomplete="tel">
            </div>
            <div class="field-group">
              <label for="profileAddress">Address</label>
              <textarea id="profileAddress" name="address" rows="3"></textarea>
            </div>
            <fieldset class="field-group">
              <legend>Change Password</legend>
              <label for="profilePassword">New Password</label>
              <input type="password" id="profilePassword" name="password" autocomplete="new-password">
            </fieldset>
            <div class="field-group">
              <button type="submit" class="btn outline">Save Changes</button>
            </div>
            <p class="form-feedback" data-feedback="profile" role="alert" aria-live="polite"></p>
          </form>
        </div>

        <div class="panel auth-panel" id="forgot-panel" hidden>
          <h3>Forgot Password</h3>
          <form id="forgot-form" novalidate>
            <div class="field-group">
              <label for="forgotEmail">Email</label>
              <input type="email" id="forgotEmail" name="email" required>
            </div>
            <div class="field-group">
              <button type="submit" class="btn outline">Send Reset Link</button>
              <button type="button" class="btn link" data-action="show-login">Back to log in</button>
            </div>
            <p class="form-feedback" data-feedback="forgot" role="alert" aria-live="polite"></p>
          </form>
        </div>

        <div class="panel auth-panel" id="reset-panel">
          <h3>Reset Password</h3>
          <form id="reset-form" novalidate>
            <div class="field-group">
              <label for="resetToken">Reset Token</label>
              <input type="text" id="resetToken" name="token" required>
            </div>
            <div class="field-group">
              <label for="resetPassword">New Password</label>
              <input type="password" id="resetPassword" name="password" required>
            </div>
            <div class="field-group">
              <button type="submit" class="btn outline">Update Password</button>
            </div>
            <p class="form-feedback" data-feedback="reset" role="alert" aria-live="polite"></p>
          </form>
        </div>
      </div>
    </div>
  </section>
<!-- Order online -->
  <section id="order" class="section alt">
    <div class="container">
      <header class="section__head">
        <h2>Order Online</h2>
        <p class="muted">Build your cart, choose pickup or delivery, and share your contact info.</p>
      </header>

      <div class="order__grid">
        <div class="panel order__products">
          <h3>Menu Items</h3>
          <ul class="order-products" aria-live="polite"></ul>
        </div>

        <div class="panel order__cart">
          <h3>Your Cart</h3>
          <p class="cart-empty">Your cart is empty. Add something tasty!</p>
          <ul class="cart-items"></ul>
          <div class="cart-summary">
            <span class="cart-total">Total: <strong><span class="cart-total-value">0.00</span> EGP</strong></span>
            <button type="button" class="btn outline cart-clear">Clear Cart</button>
          </div>
        </div>
      </div>

      <form id="order-form" class="panel order__form" novalidate>
        <h3>Checkout</h3>
        <p class="auth-hint" data-auth-required hidden>You need to be logged in before placing an order. Please sign in or create an account above.</p>

        <fieldset class="field-group">
          <legend>Order Type</legend>
          <label>
            <input type="radio" name="orderType" value="pickup" checked>
            Pickup
          </label>
          <label>
            <input type="radio" name="orderType" value="delivery">
            Delivery
          </label>
        </fieldset>

        <div class="field-group">
          <label for="customerName">Name</label>
          <input type="text" id="customerName" name="customerName" autocomplete="name" required>
        </div>

        <div class="field-group">
          <label for="customerPhone">Phone <small>(format: +20XXXXXXXXXX)</small></label>
          <input type="tel" id="customerPhone" name="customerPhone" placeholder="+2010XXXXXXXX" pattern="[+]20[0-9]{10}" required>
          <p class="input-hint">Phone number must start with +20 and include 10 more digits.</p>
        </div>

        <div class="field-group field-address" hidden>
          <label for="customerAddress">Address</label>
          <textarea id="customerAddress" name="customerAddress" rows="3" placeholder="Building, street, nearby landmark"></textarea>
        </div>

        <div class="field-group">
          <label for="paymentType">Payment</label>
          <input type="text" id="paymentType" name="paymentType" value="Cash on Pickup" readonly>
        </div>

        <div class="field-group">
          <button type="submit" class="btn red">Submit Order</button>
        </div>

        <p class="form-feedback" role="alert" aria-live="polite"></p>
      </form>
    </div>
  </section>
  <!-- Menu -->
  <section id="menu" class="section">
    <div class="container">
      <header class="section__head">
        <h2>Our Menu</h2>
        <p class="muted">Curated from our posters and menu boards.</p>
      </header>

      <div class="menu-grid">
        <div class="menu-card">
          <h3>Smash Burgers <span class="note">served with fries</span></h3>
          <ul class="menu-list">
            <li><span>Single Smashed Patty</span><i></i><b>95.00</b><div class="ingredients">Smashed patty, cheese, TUX sauce, pickles, tomato, onion, lettuce.</div></li>
            <li><span>Double Smashed Patty</span><i></i><b>140.00</b><div class="ingredients">2 smashed patties, cheese, TUX sauce, pickles, tomato, onion, lettuce.</div></li>
            <li><span>Triple Smashed Patty</span><i></i><b>160.00</b><div class="ingredients">3 smashed patties, cheese, TUX sauce, pickles, tomato, onion, lettuce.</div></li>
            <li><span>TUX Quatro Smashed Patty</span><i></i><b>190.00</b><div class="ingredients">4 smashed patties, cheese, TUX sauce, caramelized onion, mushroom.</div></li>
          </ul>
        </div>

        <div class="menu-card">
          <h3>TUXIFY</h3>
          <ul class="menu-list">
            <li><span>Single</span><i></i><b>120.00</b><div class="ingredients">Brioche bun, 1 beef patty, American cheese, pickles, chopped onion, ketchup, TUXIFY sauce.</div></li>
            <li><span>Double</span><i></i><b>160.00</b><div class="ingredients">Brioche bun, 2 beef patties, American cheese, pickles, chopped onion, ketchup, TUXIFY sauce.</div></li>
            <li><span>Triple</span><i></i><b>200.00</b><div class="ingredients">Brioche bun, 3 beef patties, American cheese, pickles, chopped onion, ketchup, TUXIFY sauce.</div></li>
            <li><span>Quatro</span><i></i><b>240.00</b><div class="ingredients">Brioche bun, 4 beef patties, American cheese, pickles, chopped onion, ketchup, TUXIFY sauce.</div></li>
          </ul>
        </div>

        <div class="menu-card">
          <h3>Fries</h3>
          <ul class="menu-list">
            <li><span>Classic Fries S / L</span><i></i><b>25.00 / 30.00</b></li>
            <li><span>Cheese Fries</span><i></i><b>30.00</b></li>
            <li><span>Chili Fries</span><i></i><b>40.00</b></li>
            <li><span>TUX Fries</span><i></i><b>75.00</b><div class="ingredients">Fried, smashed patty, cheese, pickels, caramelised onion, jalapeño, TUX sauce.</div></li>
            <li><span>Doppy Fries</span><i></i><b>95.00</b></li>
          </ul>
          <p class="desc">Fries, smashed p., bacon, cheese, caramelised onion, ranch sauce, nachos, chopped green onion</p>
        </div>

        <div class="menu-card">
          <h3>Hawawshi <span class="note">served with chili sauce</span></h3>
          <ul class="menu-list">
            <li><span>Classic Hawawshi</span><i></i><b>80.00</b><div class="ingredients">Baladi bread, hawawshi meat, onion. Served with chili sauce.</div></li>
            <li><span>TUX Hawawshi</span><i></i><b>100.00</b><div class="ingredients">Baladi bread, hawawshi meat, mozzarella, onion, TUX hawawshi sauce. Served with chili sauce.</div></li>
          </ul>
        </div>

        <div class="menu-card">
          <h3>Burger Extras</h3>
          <ul class="menu-list two">
            <li><span>Extra Smashed Patty</span><i></i><b>40.00</b></li>
            <li><span>Bacon</span><i></i><b>20.00</b></li>
            <li><span>Cheese</span><i></i><b>15.00</b></li>
            <li><span>Ranch</span><i></i><b>10.00</b></li>
            <li><span>Mushroom</span><i></i><b>15.00</b></li>
            <li><span>Caramelized Onion</span><i></i><b>10.00</b></li>
            <li><span>Jalapeño</span><i></i><b>10.00</b></li>
            <li><span>TUX Sauce</span><i></i><b>10.00</b></li>
            <li><span>Extra Bun</span><i></i><b>10.00</b></li>
            <li><span>Pickle</span><i></i><b>5.00</b></li>
            <li><span>BBQ / Ketchup / Sweet Chili / Hot Sauce</span><i></i><b>5.00</b></li>
          </ul>
        </div>

        <div class="menu-card">
          <h3>Hawawshi Extras</h3>
          <ul class="menu-list">
            <li><span>Mozzarella Cheese</span><i></i><b>20.00</b></li>
            <li><span>TUX Hawawshi Sauce</span><i></i><b>10.00</b></li>
            <li><span>BBQ / Ketchup / …</span><i></i><b>5.00</b></li>
          </ul>
        </div>

        <div class="menu-card">
          <h3>Drinks</h3>
          <ul class="menu-list">
            <li><span>Soda</span><i></i><b>20.00</b></li>
            <li><span>Water</span><i></i><b>10.00</b></li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Gallery from your posters -->
  <section id="gallery" class="section alt">
    <div class="container">
      <header class="section__head">
        <h2>Poster Gallery</h2>
        <p class="muted">Burgers &amp; Fries • Hawawshi • TUXIFY</p>
      </header>
      <div class="cards">
        <a class="card" href="assets/img/menu-burger-fries.jpg" target="_blank" rel="noreferrer">
          <img src="assets/img/menu-burger-fries.jpg" alt="Menu — Burgers & Fries">
        </a>
        <a class="card" href="assets/img/menu-hawawshi.jpg" target="_blank" rel="noreferrer">
          <img src="assets/img/menu-hawawshi.jpg" alt="Menu — Hawawshi">
        </a>
        <a class="card" href="assets/img/poster-tuxify.jpg" target="_blank" rel="noreferrer">
          <img src="assets/img/poster-tuxify.jpg" alt="Poster — TUXIFY">
        </a>
      </div>
    </div>
  </section>

  <!-- Location -->
  <section id="location" class="section">
    <div class="container grid2">
      <div class="panel">
        <h2>Where to find us</h2>
        <p class="lead"><strong>El-Saada St – Zahraa El-Maadi</strong></p>
        <p>Next to <strong>Roma Cafe</strong> & <strong>Manhattan School</strong>.</p>
        <div class="hr"></div>
        <p class="lead"><strong>العنوان</strong></p>
        <p>شارع السعادة – زهراء المعادي، بجوار كافيه روما ومدرسة مانهاتن.</p>
        <div class="actions">
          <a class="btn" href="https://maps.app.goo.gl/V8U4SKzMqHvT5o2m7" target="_blank" rel="noreferrer">Open in Google Maps</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="section alt">
    <div class="container grid3">
      <div class="panel small">
        <h3>Phone</h3>
        <p><a class="btn red" href="tel:01151960048">Call 011-5196-0048</a></p>
      </div>
      <div class="panel small">
        <h3>Follow</h3>
        <ul class="list">
          <li><a href="https://www.facebook.com/profile.php?id=61560177995727" target="_blank" rel="noreferrer">Facebook</a></li>
          <li><a href="https://www.instagram.com/tux.egypt?igsh=OGR1ODh2dTVrNWlj" target="_blank" rel="noreferrer">Instagram</a></li>
        </ul>
      </div>
      <div class="panel small">
        <h3>Delivery</h3>
        <p>Daily, 4 PM – 2 AM</p>
      </div>

      <!-- Mobile-only Help Us Improve after Delivery (gold outline style) -->
      <div class="panel small mobile-only-help">
        <a class="btn gold-outline" href="https://forms.gle/rKJoUeHkgLoqTmmXA" target="_blank" rel="noreferrer"
           style="display:block;text-align:center;">
          Help Us Improve
        </a>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="container footer__row">
      <div class="footer__brand">
        <img src="assets/img/logo.jpg" alt="TUX" class="footer__logo">
        <span>© 2025 TUX — Egypt</span>
      </div>
      <a class="footer__link" href="https://maps.app.goo.gl/V8U4SKzMqHvT5o2m7" target="_blank" rel="noreferrer">
        El-Saada St – Zahraa El-Maadi • Open in Maps
      </a>
    </div>
  </footer>

  <!-- Tiny CSS: mobile-only visibility + gold outline style to match your image -->
  <style>
    /* keep this mobile-only */
    @media (min-width:840px){ .mobile-only-help{ display:none; } }

    /* use site gold (already defined in style.css as --gold) */
    .btn.gold-outline{
      background:transparent;
      color:var(--gold);
      border:3px solid var(--gold);
      border-radius:999px;          /* pill */
      padding:14px 22px;
      font-weight:800;
    }
    /* slightly larger & comfy on small screens */
    @media (max-width:839px){
      .btn.gold-outline{ font-size:18px; }
    }
  </style>
    <script type="module" src="assets/js/auth.js"></script>

   <script>
    const products = [
      { id: 'single-smash', name: 'Single Smashed Patty', price: 95.00, description: 'Smashed patty, cheese, TUX sauce, pickles, tomato, onion, lettuce.' },
      { id: 'double-smash', name: 'Double Smashed Patty', price: 140.00, description: '2 smashed patties, cheese, TUX sauce, pickles, tomato, onion, lettuce.' },
      { id: 'triple-smash', name: 'Triple Smashed Patty', price: 160.00, description: '3 smashed patties, cheese, TUX sauce, pickles, tomato, onion, lettuce.' },
      { id: 'quatro-smash', name: 'TUX Quatro Smashed Patty', price: 190.00, description: '4 smashed patties, cheese, TUX sauce, caramelized onion, mushroom.' },
      { id: 'tuxify-single', name: 'TUXIFY Single', price: 120.00, description: 'Brioche bun, beef patty, American cheese, pickles, chopped onion, ketchup, TUXIFY sauce.' },
      { id: 'tuxify-double', name: 'TUXIFY Double', price: 160.00, description: 'Brioche bun, two patties, American cheese, pickles, chopped onion, ketchup, TUXIFY sauce.' },
      { id: 'tuxify-triple', name: 'TUXIFY Triple', price: 200.00, description: 'Brioche bun, three patties, American cheese, pickles, chopped onion, ketchup, TUXIFY sauce.' },
      { id: 'tuxify-quatro', name: 'TUXIFY Quatro', price: 240.00, description: 'Brioche bun, four patties, American cheese, pickles, chopped onion, ketchup, TUXIFY sauce.' },
      { id: 'classic-fries-s', name: 'Classic Fries (S)', price: 25.00 },
      { id: 'classic-fries-l', name: 'Classic Fries (L)', price: 30.00 },
      { id: 'cheese-fries', name: 'Cheese Fries', price: 30.00 },
      { id: 'chili-fries', name: 'Chili Fries', price: 40.00 },
      { id: 'tux-fries', name: 'TUX Fries', price: 75.00, description: 'Fries with smashed patty, cheese, pickles, caramelized onion, jalapeño, TUX sauce.' },
      { id: 'doppy-fries', name: 'Doppy Fries', price: 95.00 },
      { id: 'classic-hawawshi', name: 'Classic Hawawshi', price: 80.00, description: 'Baladi bread, hawawshi meat, onion. Served with chili sauce.' },
      { id: 'tux-hawawshi', name: 'TUX Hawawshi', price: 100.00, description: 'Baladi bread, hawawshi meat, mozzarella, onion, TUX hawawshi sauce. Served with chili sauce.' },
      { id: 'extra-patty', name: 'Extra Smashed Patty', price: 40.00 },
      { id: 'bacon', name: 'Bacon', price: 20.00 },
      { id: 'cheese', name: 'Cheese Slice', price: 15.00 },
      { id: 'ranch', name: 'Ranch', price: 10.00 },
      { id: 'mushroom', name: 'Mushroom', price: 15.00 },
      { id: 'caramelized-onion', name: 'Caramelized Onion', price: 10.00 },
      { id: 'jalapeno', name: 'Jalapeño', price: 10.00 },
      { id: 'tux-sauce', name: 'TUX Sauce', price: 10.00 },
      { id: 'extra-bun', name: 'Extra Bun', price: 10.00 },
      { id: 'pickle', name: 'Pickle', price: 5.00 },
      { id: 'condiments', name: 'Condiments (BBQ / Ketchup / Sweet Chili / Hot Sauce)', price: 5.00 },
      { id: 'hawawshi-mozzarella', name: 'Hawawshi Mozzarella', price: 20.00 },
      { id: 'hawawshi-sauce', name: 'TUX Hawawshi Sauce', price: 10.00 },
      { id: 'drinks-soda', name: 'Soda', price: 20.00 },
      { id: 'drinks-water', name: 'Water', price: 10.00 }
    ];

    function activateOrderingSystem() {
      const productList = document.querySelector('.order-products');
      const cartList = document.querySelector('.cart-items');
      const cartEmptyMessage = document.querySelector('.cart-empty');
      const cartTotalValue = document.querySelector('.cart-total-value');
      const cartClearBtn = document.querySelector('.cart-clear');
      const orderForm = document.querySelector('#order-form');
      const orderTypeRadios = Array.from(orderForm.querySelectorAll('input[name="orderType"]'));
      const deliveryRadio = orderForm.querySelector('input[value="delivery"]');

    const addressGroup = orderForm.querySelector('.field-address');
      const addressField = orderForm.querySelector('#customerAddress');
      const paymentField = orderForm.querySelector('#paymentType');
      const phoneField = orderForm.querySelector('#customerPhone');
      const feedback = orderForm.querySelector('.form-feedback');
      const authNotice = orderForm.querySelector('[data-auth-required]');

      if (!productList || !cartList || !orderForm) {
        return;
      }

      const cart = [];

      const formatPrice = (value) => value.toFixed(2);

      function renderProducts() {
        products.forEach((item) => {
          const listItem = document.createElement('li');
          const head = document.createElement('div');
          head.className = 'item-head';

          const nameSpan = document.createElement('span');
          nameSpan.className = 'item-name';
          nameSpan.textContent = item.name;

          const priceSpan = document.createElement('span');
          priceSpan.className = 'item-price';
          priceSpan.textContent = `${formatPrice(item.price)} EGP`;

          head.append(nameSpan, priceSpan);
          listItem.append(head);

          if (item.description) {
            const desc = document.createElement('p');
            desc.className = 'item-desc';
            desc.textContent = item.description;
            listItem.append(desc);
          }

          const addButton = document.createElement('button');
          addButton.type = 'button';
          addButton.className = 'btn red';
          addButton.dataset.action = 'add';
          addButton.dataset.productId = item.id;
          addButton.textContent = 'Add to Cart';
          listItem.append(addButton);

          productList.append(listItem);
        });
      }

      function findProduct(productId) {
        return products.find((product) => product.id === productId);
      }

      function renderCart() {
        cartList.innerHTML = '';

        if (!cart.length) {
          cartEmptyMessage.style.display = 'block';
          cartClearBtn.disabled = true;
        } else {
          cartEmptyMessage.style.display = 'none';
          cartClearBtn.disabled = false;
        }

        let total = 0;

        cart.forEach((item) => {
          total += item.price * item.quantity;
          const li = document.createElement('li');

          const name = document.createElement('span');
          name.className = 'cart-item-name';
          name.textContent = item.name;

          const quantity = document.createElement('span');
          quantity.className = 'cart-item-qty';
          quantity.textContent = `×${item.quantity}`;

          const price = document.createElement('span');
          price.className = 'cart-item-price';
          price.textContent = `${formatPrice(item.price * item.quantity)} EGP`;

          const removeButton = document.createElement('button');
          removeButton.type = 'button';
          removeButton.dataset.action = 'remove';
          removeButton.dataset.productId = item.id;
          removeButton.textContent = 'Remove';

          li.append(name, quantity, price, removeButton);
          cartList.append(li);
        });

        cartTotalValue.textContent = formatPrice(total);
      }

      function addToCart(productId) {
        const product = findProduct(productId);
        if (!product) return;

        const existing = cart.find((entry) => entry.id === productId);
        if (existing) {
          existing.quantity += 1;
        } else {
          cart.push({ id: productId, name: product.name, price: product.price, quantity: 1 });
        }

        renderCart();
        showFeedback('success', `${product.name} added to your cart.`);
      }

      function removeFromCart(productId) {
        const index = cart.findIndex((entry) => entry.id === productId);
        if (index !== -1) {
          const [removed] = cart.splice(index, 1);
          renderCart();
          showFeedback('success', `${removed.name} removed from your cart.`);
        }
      }

      function clearCart() {
        cart.length = 0;
        renderCart();
      }

      function showFeedback(type, message) {
        feedback.textContent = message;
        feedback.classList.remove('success', 'error');
        if (!message) return;
        feedback.classList.add(type === 'success' ? 'success' : 'error');
      }
 function populateFromProfile(user) {
        if (!user) {
          if (authNotice) authNotice.hidden = false;
          return;
        }
        if (authNotice) authNotice.hidden = true;

        if (user.name) orderForm.customerName.value = user.name;
        if (user.phone) phoneField.value = user.phone;
        if (user.address) {
          addressField.value = user.address;
          if (addressField.value && deliveryRadio) {
            deliveryRadio.checked = true;
            updateOrderTypeUI('delivery');
          }
        }
      }
      function updateOrderTypeUI(orderType) {
        if (orderType === 'delivery') {
          addressGroup.hidden = false;
          addressField.required = true;
          paymentField.value = 'Cash on Delivery';
        } else {
          addressGroup.hidden = true;
          addressField.required = false;
          addressField.value = '';
          paymentField.value = 'Cash on Pickup';
        }
      }

      function validatePhone() {
        const isValid = /^\+20\d{10}$/.test(phoneField.value.trim());
        if (!isValid && phoneField.value.trim() !== '') {
          phoneField.setCustomValidity('Phone number must start with +20 followed by 10 digits.');
        } else {
          phoneField.setCustomValidity('');
        }
      }

      renderProducts();
      renderCart();
      updateOrderTypeUI('pickup');

      productList.addEventListener('click', (event) => {
        const button = event.target.closest('button[data-action="add"]');
        if (!button) return;
        addToCart(button.dataset.productId);
      });

      cartList.addEventListener('click', (event) => {
        const button = event.target.closest('button[data-action="remove"]');
        if (!button) return;
        removeFromCart(button.dataset.productId);
      });

      cartClearBtn.addEventListener('click', () => {
        clearCart();
        showFeedback('success', 'Cart cleared.');
      });

      orderTypeRadios.forEach((radio) => {
        radio.addEventListener('change', (event) => {
          if (event.target.checked) {
            updateOrderTypeUI(event.target.value);
          }
        });
      });

      phoneField.addEventListener('input', validatePhone);
      phoneField.addEventListener('blur', validatePhone);
  document.addEventListener('auth:changed', (event) => {
        populateFromProfile(event.detail && event.detail.user);
      });

      populateFromProfile(window.__authState && window.__authState.user);
      orderForm.addEventListener('submit', (event) => {
        event.preventDefault();
        validatePhone();

        if (!orderForm.reportValidity()) {
          showFeedback('error', 'Please fix the highlighted fields and try again.');
          return;
        }

        const authState = window.__authState || {};
        if (!authState.user) {
          showFeedback('error', 'Please log in or register before submitting your order.');
          if (authNotice) authNotice.hidden = false;
          return;
        }

        if (!cart.length) {
          showFeedback('error', 'Your cart is empty. Add at least one item to continue.');
          return;
        }
        

        const orderType = orderForm.querySelector('input[name="orderType"]:checked').value;
        const name = orderForm.customerName.value.trim();
        const phone = phoneField.value.trim();
        const address = addressField.value.trim();

        let confirmation = `Thanks ${name}! We will contact you shortly on ${phone} to confirm your ${orderType} order.`;
        if (orderType === 'delivery') {
          confirmation += ` Delivery address: ${address || 'not provided'}.`;
        }

        showFeedback('success', confirmation);
        clearCart();
        orderForm.reset();
        updateOrderTypeUI('pickup');
        paymentField.value = 'Cash on Pickup';
                populateFromProfile(authState.user);

      });
    }

    // Comment out the next line if you want to temporarily disable the add to cart functionality.
    activateOrderingSystem();
  </script>
</body>
</html>
